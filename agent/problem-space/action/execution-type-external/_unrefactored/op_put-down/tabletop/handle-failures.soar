sp {op_put-down1*tabletop*propose*handle-command-failure
   (state <s> ^name op_put-down1
              ^current-task-segment <seg>)
   (<seg> ^put-down-command <cmd>)
   (<cmd> ^status error)
-->
   (<s> ^operator <o> + = >)
   (<o> ^name handle-command-failure
        ^category failure-handling
        ^task-segment <seg>
        ^command <cmd>)
}

sp {op_put-down1*tabletop*propose*handle-missing-object-failure
   (state <s> ^name op_put-down1
              ^current-task-segment <seg>
              ^put-down-command.status success
              ^target-object <obj>)
   (<obj> ^predicates.is-visible1 not-visible1)
-->
   (<s> ^operator <o> + = >)
   (<o> ^name handle-missing-object-failure
        ^category failure-handling
        ^task-segment <seg>
        ^object <obj>)
}

sp {op_put-down1*tabletop*elaborate*unrecoverable-failure*goal-failure
   (state <s> ^name op_put-down1
              ^current-task-segment <seg>
              ^put-down-command.status success
              ^target-object.predicates.is-visible1 visible1
              ^predicate-satisfied false)
-->
   (<seg> ^unrecoverable-failure goal-failure)
}


## Report failure if there are no more candidates for the missing object
#sp {op_put-down1*tabletop*propose*report-failure
#   (state <s> ^name op_put-down1
#              ^problem-space.execution-type external
#              ^current-task-segment.put-down-command.status success
#             -^top-state.perception-monitor.object-monitor.new-object-info.status
#              ^held-object.predicates.is-visible1 not-visible1)
#-->
#   (<s> ^operator <o> +)
#   (<o> ^name report-failure)
#}
#
## Report a failure, may lead to more interactions
#sp {op_put-down1*tabletop*apply*report-failure*report*failure
#   (state <s> ^name op_put-down1
#              ^operator.name report-failure
#              ^held-object <obj>
#              ^top-state.interaction.status <status>)
#-->
#   (<status> ^failure <f>)
#   (<f> ^type missing-object
#        ^missing-object <obj>)
#}
#
#sp {op_put-down1*tabletop*apply*report-failure*remove*grabbed
#   (state <s> ^name op_put-down1
#              ^operator.name report-failure
#              ^held-object.predicates <preds>)
#   (<preds> ^arm-status grabbed)
#-->
#   (<preds> ^arm-status grabbed -
#            ^arm-status not-grabbed)
#}
#
#sp {op_put-down1*tabletop*apply*report-failure*remove*put-down-command
#   (state <s> ^name op_put-down1
#              ^operator.name report-failure
#              ^current-task-segment <seg>
#              ^io.output-link <out>)
#   (<seg> ^put-down-command <cmd>)
#   (<out> ^put-down <cmd>)
#-->
#   (<seg> ^put-down-command <cmd> -)
#   (<out> ^put-down <cmd> -)
#}
