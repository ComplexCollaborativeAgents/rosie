# If the subtask was given when the agent didn't have a goal
# (Finished with the current goal and doesn't have a next one)
# Then add a new procedural goal onto the goal-graph after the current goal

sp {learn-new-subtask*propose*add-node-to-goal-graph*subtask
   (state <s> ^name learn-new-subtask
              ^task-operator.task-handle <task-h>
              ^current-goal-id.handle <goal-h>
              ^superstate.desired <des>
              ^subtask-handle <sub-h>
             -^created-subtask-goal)
   (<des> ^handle <goal-h>
          ^satisfied true)
-->
   (<s> ^operator <o> + =)
   (<o> ^name add-node-to-goal-graph
        ^type subtask
        ^task-handle <task-h>
        ^subtask-handle <sub-h>
        ^after <goal-h>)
}

sp {learn-new-subtask*apply*add-node-to-goal-graph*subtask
   (state <s> ^name learn-new-subtask
              ^operator <o>)
   (<o> ^name add-node-to-goal-graph
        ^type subtask
        ^add-node-result <node-h>)
-->
   (<s> ^created-subtask-goal <node-h>)
}

